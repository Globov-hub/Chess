% Заданные параметры
Um = 10;    % Амплитуда
tu = 6;     % Длительность импульса
T = 12;     % Период сигнала
k_max = 20; % Количество гармоник для построения

% Расчет параметров
omega1 = pi/6; % Основная частота

% Создание массива гармоник
k = 1:k_max;

% Расчет амплитудного спектра
Ak = (2*Um/3) ./ (k*omega1) .* (sin(k*omega1*tu/4)).^2;

% Расчет фазового спектра в радианах
Phik_rad = pi/2 - (k*omega1*tu)/2;

% Преобразование фазы в градусы и приведение к диапазону [-180, 180]
Phik_deg = rad2deg(Phik_rad);
Phik_deg = mod(Phik_deg + 180, 360) - 180; % Приведение к [-180, 180]

% Построение графиков
figure;

% Амплитудный спектр
subplot(2,1,1);
stem(k, Ak, 'filled', 'LineWidth', 1.5, 'MarkerSize', 5);
title('Амплитудный дискретный спектр');
xlabel('Номер гармоники (k)');
ylabel('Амплитуда (A_k)');
grid on;

% Фазовый спектр в градусах
subplot(2,1,2);
stem(k, Phik_deg, 'filled', 'LineWidth', 1.5, 'MarkerSize', 5);
title('Фазовый дискретный спектр');
xlabel('Номер гармоники (k)');
ylabel('Фаза (Φ_k), градусы');
ylim([-180 180]); % Фиксируем диапазон по оси Y
yticks(-180:90:180); % Метки на оси Y
grid on;

% Настройка общего вида
sgtitle('Дискретные спектры сигнала для первых 20 гармоник');

Ak
Phik_rad